<!DOCTYPE html>
<html lang="en">

<head>
	<title>Commuting in France (based on national statistics and made with Gephi)</title>
	<link rel="icon" href="favicon.ico" />
	<meta charset="utf-8" />

	<style>
	html, body {height: 100%;margin: 0;padding: 0;}
	#map {width:100%;height:100%;color: #CCC;background: #262626;}
	</style>

	<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-54391617-1', 'auto');
	ga('send', 'pageview');
	</script>

</head>
<body>

	<div id="fork" style="z-index: 9999; position: absolute; top: 10px; right: 10px; border: 0;">
		<iframe src="http://ghbtns.com/github-btn.html?user=charnould&repo=shuttle&type=fork&size=large"
		allowtransparency="true" frameborder="0" scrolling="0" width="79" height="30"></iframe>
	</div>

	<div id="map"></div>
	<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>

	<script>
	var repeatOnXAxis = false;

	function getNormalizedCoord(coord, zoom) {
		if (!repeatOnXAxis) return coord;

		var y = coord.y;
		var x = coord.x;

		var tileRange = 1 << zoom;

		if (y < 0 || y >= tileRange) {
			return null;
		}

		if (x < 0 || x >= tileRange) {
			x = (x % tileRange + tileRange) % tileRange;
		}

		return {
			x: x,
			y: y
		};

	}

	window.onload = function() {

		var customMapType = new google.maps.ImageMapType({
			getTileUrl: function(coord, zoom) {
				var normalizedCoord = getNormalizedCoord(coord, zoom);
				if(normalizedCoord && (normalizedCoord.x < Math.pow(2, zoom)) && (normalizedCoord.x > -1) && (normalizedCoord.y < Math.pow(2, zoom)) && (normalizedCoord.y > -1)) {
					return zoom + '_' + normalizedCoord.x + '_' + normalizedCoord.y + '.png';
				} else {
					return 'empty.png';
				}
			},
			tileSize: new google.maps.Size(256, 256),
			maxZoom: 5,
			name: 'Commuting in France'
		});

		var myOptions = {
			center: new google.maps.LatLng(50, -79),
			zoom: 3,
			minZoom: 0,
			streetViewControl: false,
			mapTypeControl: false,
			mapTypeControlOptions: {
				mapTypeIds: ["custom"]
			}
		};


		var map = new google.maps.Map(document.getElementById('map'), myOptions);
		map.mapTypes.set('custom', customMapType);
		map.setMapTypeId('custom');

	}
	</script>

</body>
</html>
